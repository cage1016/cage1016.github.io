<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>Deploy Gokit Todo to GAE With Cloud Build From Github Repo - KaiChu</title><meta name=Description content="gokit-todo, gokit-todo-frontend are applications developed with low dependencies on code suites and simple tasks on Kubernetes. We can easily migrate to Google App Engine for CI/CD development process using Google Cloud Build and Github repo."><meta property="og:title" content="Deploy Gokit Todo to GAE With Cloud Build From Github Repo"><meta property="og:description" content="gokit-todo, gokit-todo-frontend are applications developed with low dependencies on code suites and simple tasks on Kubernetes. We can easily migrate to Google App Engine for CI/CD development process using Google Cloud Build and Github repo."><meta property="og:type" content="article"><meta property="og:url" content="https://kaichu.io/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/"><meta property="og:image" content="https://kaichu.io/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/placeholder.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-03-27T07:16:36+00:00"><meta property="article:modified_time" content="2023-09-03T22:53:05+08:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://kaichu.io/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/placeholder.png"><meta name=twitter:title content="Deploy Gokit Todo to GAE With Cloud Build From Github Repo"><meta name=twitter:description content="gokit-todo, gokit-todo-frontend are applications developed with low dependencies on code suites and simple tasks on Kubernetes. We can easily migrate to Google App Engine for CI/CD development process using Google Cloud Build and Github repo."><meta name=application-name content="KaiChu"><meta name=apple-mobile-web-app-title content="KaiChu"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://kaichu.io/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/><link rel=prev href=https://kaichu.io/posts/wason-language-translator-cli/><link rel=next href=https://kaichu.io/posts/alfred-open-chinese-convert/><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13.0/css/all.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@3.7.2/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Deploy Gokit Todo to GAE With Cloud Build From Github Repo","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/kaichu.io\/posts\/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo\/"},"image":[{"@type":"ImageObject","url":"https:\/\/kaichu.io\/posts\/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo\/img\/placeholder.png","width":3e3,"height":1687}],"genre":"posts","keywords":"gokit, todomvc, gcp, gae, postgres, cloudsql","wordcount":944,"url":"https:\/\/kaichu.io\/posts\/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo\/","datePublished":"2022-03-27T07:16:36+00:00","dateModified":"2023-09-03T22:53:05+08:00","license":"This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher":{"@type":"Organization","name":"KAI CHU CHUNG","logo":"https:\/\/kaichu.io\/images\/avatar.png"},"author":{"@type":"Person","name":"KAI CHU CHUNG"},"description":"gokit-todo, gokit-todo-frontend are applications developed with low dependencies on code suites and simple tasks on Kubernetes. We can easily migrate to Google App Engine for CI/CD development process using Google Cloud Build and Github repo."}</script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title=KaiChu>KaiChu</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/ title=Home>Home </a><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/tags/alfred>Alfred </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/about/>About </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item language" title="Select Language">English<i class="fas fa-chevron-right fa-fw"></i>
<select class=language-select id=language-select-desktop onchange="location=this.value"><option value=/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/ selected>English</option><option value=/zh-tw/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/>ÁπÅÈ´î‰∏≠Êñá</option></select>
</a><span class="menu-item search" id=search-desktop><input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin"></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title=KaiChu>KaiChu</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin"></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/ title=Home>Home</a><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/tags/alfred title>Alfred</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/about/ title>About</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i>
</a><a href=javascript:void(0); class=menu-item title="Select Language">English<i class="fas fa-chevron-right fa-fw"></i>
<select class=language-select onchange="location=this.value"><option value=/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/ selected>English</option><option value=/zh-tw/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/>ÁπÅÈ´î‰∏≠Êñá</option></select></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class="toc-content always-active" id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animated flipInX">Deploy Gokit Todo to GAE With Cloud Build From Github Repo</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw"></i>KAI CHU CHUNG</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2022-03-27>2022-03-27</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;944 words&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;2 minutes&nbsp;</div></div><div class="details toc" id=toc-static kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#gokit-todo>gokit-todo</a></li><li><a href=#migrate-gokit-todo-gokit-todo-frontent-to-google-app-engine-with-cloud-sql>migrate gokit-todo gokit-todo-frontent to Google App Engine with Cloud SQL</a></li><li><a href=#google-app-engine>Google App Engine</a></li><li><a href=#cloud-sql>Cloud SQL</a></li><li><a href=#google-cloud-build>Google Cloud Build</a></li><li><a href=#gokit-todo-gae>gokit-todo-gae</a></li><li><a href=#summary>summary</a></li></ul></nav></div></div><div class=content id=content><h2 id=gokit-todo>gokit-todo</h2><p><a href=https://github.com/cage1016/gokit-todo target=_blank rel="noopener noreffer">https://github.com/cage1016/gokit-todo</a></p><blockquote><p>todomvc full stack demo project. react + backend API by gokit microservice toolkit. include unit test, integration test, e2e test, github action ci</p></blockquote><p><a href=https://github.com/cage1016/gokit-todo-frontend target=_blank rel="noopener noreffer">https://github.com/cage1016/gokit-todo-frontend</a></p><blockquote><p>gokit todo frotnend: React todomvc</p></blockquote><a class=lightgallery href=/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/demo.gif title="gokit-todo demo" data-thumbnail=/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/demo.gif><img class=lazyload src=/svg/loading.min.svg data-src=/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/demo.gif data-srcset="/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/demo.gif, /posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/demo.gif 1.5x, /posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/demo.gif 2x" data-sizes=auto alt="gokit-todo demo"></a><p><code>gokit-doto</code> (Microservices backend API with Postgres database) and <code>gokit-todo-frontend</code> (React todomvc) are demo applications developed for Kubernetes with Ingress (Istio/Nginx-ingress). You can also quickly start an entire application with a database via docker-compose. Feel free to try it out by following the guide in the repo.</p><h2 id=migrate-gokit-todo-gokit-todo-frontent-to-google-app-engine-with-cloud-sql>migrate gokit-todo gokit-todo-frontent to Google App Engine with Cloud SQL</h2><p>Before we migrated our Kubernetes application to Google App Engine. We first need to have some understanding of Google App Engine. Make sure our ideas work.</p><ol><li>Google App Engine is a Pass (Platform as a Service) service, which means we only need to focus on application development. So we can reuse gokit-todo, gokit-todo-frontend source code and deploy to Google App Engine through <code>app.yaml</code> configuration ‚úÖ</li><li>Google App Engine support standard-runtime (<code>Python</code>, <code>Java</code>, Node.<code>js</code>, <code>PHP</code>, <code>Ruby</code>, <code>Go</code>) and flexible-runtime (<code>Go</code>, <code>Java 8</code>, <code>PHP 5/7</code>, <code>Python 2.7/3.6</code>, <code>.NET</code>, <code>Node.js</code>, <code>Ruby</code>, <code>Custom runtime</code>)<ul><li>Choose standard runtime Go 1.16 for gokit-todo as it is a pure backend API microservice ‚úÖ</li><li>Chosee standard-runtime Node.js 16 for gokit-todo-frontentd as it is React frontend application ‚úÖ</li></ul></li><li>We can choose Cloud SQL (Postgres) as our database to gokit-todo application in Google App Engine environment. You must use Cloud SQL proxy postgres driver <code>cloudsqlpostgres</code> to connect to Cloud SQL cause Cloud SQL will handle the connection authentication and authorization automatically. ‚úÖ</li><li>We can choose Google Cloud Build to handle CI/CD pipeline workflow and fully integrate with Github repo. There is most important things is you need to grant project default Google Cloud service account <code>project-number@cloudbuild.gserviceaccount.com</code> with enough permissions to build and deploy your application. ‚úÖ
<a class=lightgallery href=/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/cloudbuild%20permission.jpg title="Google Cloud Build permission" data-thumbnail="/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/cloudbuild permission.jpg"><img class=lazyload src=/svg/loading.min.svg data-src=/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/cloudbuild%20permission.jpg data-srcset="/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/cloudbuild%20permission.jpg, /posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/cloudbuild%20permission.jpg 1.5x, /posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/cloudbuild%20permission.jpg 2x" data-sizes=auto alt="Google Cloud Build permission"></a></li></ol><p><strong>Architecture</strong></p><a class=lightgallery href=/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/placeholder.png title="gokit-todo-gae architecture" data-thumbnail=/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/placeholder.png><img class=lazyload src=/svg/loading.min.svg data-src=/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/placeholder.png data-srcset="/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/placeholder.png, /posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/placeholder.png 1.5x, /posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/placeholder.png 2x" data-sizes=auto alt="gokit-todo-gae architecture"></a><p>Above is the whole architecture of our application <code>gokit-todo-gae</code> leverage with <code>gokit-todo</code> and <code>gokit-todo-frontend</code> as git submodule. Using a project with git submodules avoids the overhead of interfering with the application source code.</p><h2 id=google-app-engine>Google App Engine</h2><p>It&rsquo;s very basic setup for our demo scenario. Just enable Google App Engine service in Google Cloud project and we will leverage Google Cloud Build to handle all depoyment jobs</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>gcloud app create --region<span class=o>=</span>asia-east1
</span></span></code></pre></td></tr></table></div></div><h2 id=cloud-sql>Cloud SQL</h2><p>You can create a Cloud SQL instance in Google Cloud Console or <code>gcloud sql instances create</code> command. The following gcloud command will create a Cloud SQL.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>gcloud sql instances create todo --database-version<span class=o>=</span>POSTGRES_11 --cpu<span class=o>=</span><span class=m>1</span> --memory<span class=o>=</span>3840MiB --region<span class=o>=</span>asia-east1 --root-password<span class=o>=</span>password --storage-size<span class=o>=</span>10GB --storage-type<span class=o>=</span>SSD
</span></span></code></pre></td></tr></table></div></div><p>When Cloud SQL instance is created then we need to crate a demo database.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>gcloud sql databases create todo -i todo
</span></span></code></pre></td></tr></table></div></div><p>It&rsquo;s quick simple step to create a Cloud SQL instance and a demo database via gcloud command. Cloud SQL instance setup with Public IP address as default and you can also setup with Private IP address as your want. Make sure you enable VPC network for your private IP address Cloud SQL instance.</p><h2 id=google-cloud-build>Google Cloud Build</h2><p>As previous mentioned that all CI/CD jobs are handled by Google Cloud Build. We need to create a bunch of Cloud Build configurations to build and deploy our application.</p><ol><li><p>We added <code>gokit-todo</code> and <code>gokit-todo-frontend</code> application as project git submodule. We create a Cloud Build configuration for <code>gokit-todo</code> and <code>gokit-todo-frontend</code> and each of them could trigger another cloud build trigger to deploy application.</p><a class=lightgallery href=/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/submodule%20trigger.jpg title="submodule triggers" data-thumbnail="/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/submodule trigger.jpg"><img class=lazyload src=/svg/loading.min.svg data-src=/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/submodule%20trigger.jpg data-srcset="/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/submodule%20trigger.jpg, /posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/submodule%20trigger.jpg 1.5x, /posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/submodule%20trigger.jpg 2x" data-sizes=auto alt="submodule triggers"></a><blockquote><p>It&rsquo;s useful tips to trigger Cloud Build trigger by RESTful API in one Cloud Build steps.</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl -d <span class=s1>&#39;{&#34;branchName&#34;:&#34;master&#34;}&#39;</span> -X POST -H <span class=s2>&#34;Content-type: application/json&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -H <span class=s2>&#34;Authorization: Bearer </span><span class=k>$(</span>gcloud config config-helper --format<span class=o>=</span><span class=s1>&#39;value(credential.access_token)&#39;</span><span class=k>)</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    https://cloudbuild.googleapis.com/v1/projects/&lt;gcp-project&gt;/triggers/&lt;cloudbuild-trigger-id&gt;:run
</span></span></code></pre></td></tr></table></div></div></li><li><p>Trigger trigger <code>gokit-todo</code> and <code>gokit-todo-frontend</code> by <code>cloudbuild.api.yaml</code> Âèä <code>cloudbuild.default.yaml</code></p><a class=lightgallery href=/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/api%20default%20trigger.jpg title="api/default triggers" data-thumbnail="/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/api default trigger.jpg"><img class=lazyload src=/svg/loading.min.svg data-src=/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/api%20default%20trigger.jpg data-srcset="/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/api%20default%20trigger.jpg, /posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/api%20default%20trigger.jpg 1.5x, /posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/api%20default%20trigger.jpg 2x" data-sizes=auto alt="api/default triggers"></a></li><li><p>It&rsquo;s also to deploy Google App Engine dispatch router <code>dispatch.yaml</code> settings through <code>cloudbuild.dispatch.yaml</code></p></li></ol><p><strong>All of Cloud Build settings</strong>
<a class=lightgallery href=/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/cloudbuild-trigger.jpg title="Cloud Build triggers" data-thumbnail=/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/cloudbuild-trigger.jpg><img class=lazyload src=/svg/loading.min.svg data-src=/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/cloudbuild-trigger.jpg data-srcset="/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/cloudbuild-trigger.jpg, /posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/cloudbuild-trigger.jpg 1.5x, /posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/cloudbuild-trigger.jpg 2x" data-sizes=auto alt="Cloud Build triggers"></a></p><h2 id=gokit-todo-gae>gokit-todo-gae</h2><p><strong><a href=https://github.com/cage1016/gokit-todo-gae target=_blank rel="noopener noreffer">cage1016/gokit-todo-gae</a></strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>.
</span></span><span class=line><span class=cl>‚îú‚îÄ‚îÄ api                       // gokit-todo submodule as api service
</span></span><span class=line><span class=cl>‚îú‚îÄ‚îÄ default                   // gokit-todo-frontend as default service
</span></span><span class=line><span class=cl>‚îú‚îÄ‚îÄ .gitmodules
</span></span><span class=line><span class=cl>‚îú‚îÄ‚îÄ cloudbuild.api.yaml       // deploy api service <span class=o>(</span>Manual<span class=o>)</span>
</span></span><span class=line><span class=cl>‚îú‚îÄ‚îÄ cloudbuild.default.yaml   // deploy default service <span class=o>(</span>Manual<span class=o>)</span>
</span></span><span class=line><span class=cl>‚îú‚îÄ‚îÄ cloudbuild.dispatch.yaml  // deploy dispatch.yaml
</span></span><span class=line><span class=cl>‚îî‚îÄ‚îÄ dispatch.yaml             // gokit-todo-gae dispatch yaml
</span></span></code></pre></td></tr></table></div></div><p>You can see above project file structure (gokit-todo-gae) is same as previous architecture diagram. The operation process is as follows</p><ol><li><p>Frontend developer push code to Github repo <code>gokit-todo-frontend</code> üëâ trigger <code>gokit-todo-frontend</code> will be triggered and do their steps job and trigger <code>gokit-todo-gae-deploy-default</code> trigger by RESTFul API at last step üëâ trigger <code>gokit-todo-gae-deploy-default</code> will build and deploy <code>gokit-todo-frontend</code> application to Google App Engine.</p><p><strong>cloudbuild.yaml</strong>
<a class=lightgallery href=/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/gokit-todo-frontend-cloudbuild.yaml.jpg title="gokit-todo-frontend cloudbuild.yaml" data-thumbnail=/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/gokit-todo-frontend-cloudbuild.yaml.jpg><img class=lazyload src=/svg/loading.min.svg data-src=/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/gokit-todo-frontend-cloudbuild.yaml.jpg data-srcset="/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/gokit-todo-frontend-cloudbuild.yaml.jpg, /posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/gokit-todo-frontend-cloudbuild.yaml.jpg 1.5x, /posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/gokit-todo-frontend-cloudbuild.yaml.jpg 2x" data-sizes=auto alt="gokit-todo-frontend cloudbuild.yaml"></a></p><p><strong>cloudbuild.default.yaml</strong>
<a class=lightgallery href=/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/gokit-todo-gae-cloudbuild.default.yaml.jpg title="gokit-todo-gae deploy default service" data-thumbnail=/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/gokit-todo-gae-cloudbuild.default.yaml.jpg><img class=lazyload src=/svg/loading.min.svg data-src=/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/gokit-todo-gae-cloudbuild.default.yaml.jpg data-srcset="/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/gokit-todo-gae-cloudbuild.default.yaml.jpg, /posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/gokit-todo-gae-cloudbuild.default.yaml.jpg 1.5x, /posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/gokit-todo-gae-cloudbuild.default.yaml.jpg 2x" data-sizes=auto alt="gokit-todo-gae deploy default service"></a></p></li><li><p>Backend developer push code to Github repo <code>gokit-todo</code> üëâ trigger <code>gokit-todo</code> will be triggered and do their steps job (application testing) and trigger <code>gokit-todo-gae-deploy-api</code> trigger by RESTFul API at last step üëâ trigger <code>gokit-todo-gae-deploy-api</code> will build and deploy <code>gokit-todo</code> application to Google App Engine.</p><p><strong>cloudbuild.yaml</strong>
<a class=lightgallery href=/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/gokit-todo-cloudbuild.yaml.jpg title="gokit-todo cloudbuild.yaml" data-thumbnail=/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/gokit-todo-cloudbuild.yaml.jpg><img class=lazyload src=/svg/loading.min.svg data-src=/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/gokit-todo-cloudbuild.yaml.jpg data-srcset="/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/gokit-todo-cloudbuild.yaml.jpg, /posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/gokit-todo-cloudbuild.yaml.jpg 1.5x, /posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/gokit-todo-cloudbuild.yaml.jpg 2x" data-sizes=auto alt="gokit-todo cloudbuild.yaml"></a></p><p><strong>cloudbuild.api.yaml</strong>
<a class=lightgallery href=/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/gokit-todo-gae-cloudbuild.api.yaml.jpg title="gokit-todo-gae deploy api service" data-thumbnail=/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/gokit-todo-gae-cloudbuild.api.yaml.jpg><img class=lazyload src=/svg/loading.min.svg data-src=/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/gokit-todo-gae-cloudbuild.api.yaml.jpg data-srcset="/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/gokit-todo-gae-cloudbuild.api.yaml.jpg, /posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/gokit-todo-gae-cloudbuild.api.yaml.jpg 1.5x, /posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/gokit-todo-gae-cloudbuild.api.yaml.jpg 2x" data-sizes=auto alt="gokit-todo-gae deploy api service"></a></p></li><li><p>It&rsquo;s also easy to update Google App Engine dispatch routing setting by push <code>dispatch.yaml</code> changed to Github repo <code>gokit-todo-gae</code> üëâ trigger <code>gokit-todo-gae-deploy-dispatch</code> will update dispatch routing to Google App Engine</p><p><strong>cloudbuild.dispatch.yaml</strong>
<a class=lightgallery href=/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/cloudbuild.dispatch.yaml.jpg title="gokit-todo-gae deploy dispatch.yaml" data-thumbnail=/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/cloudbuild.dispatch.yaml.jpg><img class=lazyload src=/svg/loading.min.svg data-src=/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/cloudbuild.dispatch.yaml.jpg data-srcset="/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/cloudbuild.dispatch.yaml.jpg, /posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/cloudbuild.dispatch.yaml.jpg 1.5x, /posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/cloudbuild.dispatch.yaml.jpg 2x" data-sizes=auto alt="gokit-todo-gae deploy dispatch.yaml"></a></p></li></ol><h2 id=summary>summary</h2><p>Google App Engine is easy to get started with. In particular, for simple applications like this demo, the Google App Engine standard-runtime offers a free tier of 28 instance-hours per day. We can migrate pre Kubernetes application <code>gokit-todo</code> and <code>gokit-todo-frontend</code> to Google App Engine without any code modified, just leverage with requirement <code>app.yaml</code> and Google App Engine could collaborate with GitHub Repo and Google Cloud Build well.</p><p><strong>Q</strong>
Why don&rsquo;t we use Github build-in CI/CD Github action instead of Google Cloud Build ?</br><strong>A</strong>
Yes, You could do HTTP request to trigger Google Cloud Build trigger in Github Action but have to handle request authentication by yourself. Google Cloud Build will auto handle those request authentication automatically</p><a class=lightgallery href=/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/gokit-todo-gae.gif title="gokit todo GAE" data-thumbnail=/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/gokit-todo-gae.gif><img class=lazyload src=/svg/loading.min.svg data-src=/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/gokit-todo-gae.gif data-srcset="/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/gokit-todo-gae.gif, /posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/gokit-todo-gae.gif 1.5x, /posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/img/gokit-todo-gae.gif 2x" data-sizes=auto alt="gokit todo GAE"></a><p><strong>source code</strong></p><ul><li><code>gokit-todo</code> <a href=https://github.com/cage1016/gokit-todo target=_blank rel="noopener noreffer">https://github.com/cage1016/gokit-todo</a></li><li><code>gokit-todo-frontend</code> <a href=https://github.com/cage1016/gokit-todo-frontend target=_blank rel="noopener noreffer">https://github.com/cage1016/gokit-todo-frontend</a></li><li><code>gokit-todo-gae</code> <a href=https://github.com/cage1016/gokit-todo-gae target=_blank rel="noopener noreffer">https://github.com/cage1016/gokit-todo-gae</a></li></ul></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2023-09-03&nbsp;<a class=git-hash href=https://github.com/cage1016/kaichu.io.hugo/commit/f97d4c12042b9ed1f59abac48c7e3d1bafc1c6c6 target=_blank title="commit by Kai-Chu Chung(cage.chung@gmail.com) f97d4c12042b9ed1f59abac48c7e3d1bafc1c6c6: add Golang Alfred Workflow Generator Ak">
<i class="fas fa-hashtag fa-fw"></i>f97d4c1</a></span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/index.md target=_blank>Read Markdown</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://kaichu.io/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/ data-title="Deploy Gokit Todo to GAE With Cloud Build From Github Repo" data-via=CageChung data-hashtags=gokit,todomvc,gcp,gae,postgres,cloudsql><i class="fab fa-twitter fa-fw"></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://kaichu.io/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/ data-hashtag=gokit><i class="fab fa-facebook-square fa-fw"></i></a><a href=javascript:void(0); title="Share on Linkedin" data-sharer=linkedin data-url=https://kaichu.io/posts/deploy-gokit-todo-to-gae-with-cloud-build-from-github-repo/><i class="fab fa-linkedin fa-fw"></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/gokit/>gokit</a>,&nbsp;<a href=/tags/todomvc/>todomvc</a>,&nbsp;<a href=/tags/gcp/>GCP</a>,&nbsp;<a href=/tags/gae/>GAE</a>,&nbsp;<a href=/tags/postgres/>postgres</a>,&nbsp;<a href=/tags/cloudsql/>cloudsql</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/posts/wason-language-translator-cli/ class=prev rel=prev title="Wason Language Translator CLI"><i class="fas fa-angle-left fa-fw"></i>Wason Language Translator CLI</a>
<a href=/posts/alfred-open-chinese-convert/ class=next rel=next title="Alfred Open Chinese Convert">Alfred Open Chinese Convert<i class="fas fa-angle-right fa-fw"></i></a></div></div><div id=comments><div id=utterances></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://utteranc.es/>Utterances</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.118.2">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a></div><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2019 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank>KAI CHU CHUNG</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw"></i></a></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/lightgallery.js@1.2.0/dist/css/lightgallery.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/asciinema-player@2.6.1/resources/public/css/asciinema-player.css><script type=text/javascript src=https://cdn.jsdelivr.net/npm/smooth-scroll@16.1.3/dist/smooth-scroll.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/autocomplete.js@0.37.1/dist/autocomplete.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/algoliasearch@4.2.0/dist/algoliasearch-lite.umd.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.2.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery.js@1.2.0/dist/js/lightgallery.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lg-thumbnail.js@1.2.0/dist/lg-thumbnail.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lg-zoom.js@1.2.0/dist/lg-zoom.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.4.0/sharer.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:1e3},comment:{utterances:{darkTheme:"github-dark",issueTerm:"pathname",label:"comment",lightTheme:"github-light",repo:"cage1016/cage1016.github.io"}},lightGallery:{actualSize:!1,exThumbImage:"data-thumbnail",hideBarsDelay:2e3,selector:".lightgallery",speed:400,thumbContHeight:80,thumbWidth:80,thumbnail:!0},search:{algoliaAppID:"IB21BAKK19",algoliaIndex:"index.en",algoliaSearchKey:"8883d25f4767d3d2848450e3afa6cf05",highlightTag:"em",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"algolia"}}</script><script type=text/javascript src=/js/theme.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/asciinema-player@2.6.1/resources/public/js/asciinema-player.min.js></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-65308340-1",{anonymize_ip:!0})</script><script type=text/javascript src="https://www.googletagmanager.com/gtag/js?id=UA-65308340-1" async></script></body></html>