<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>Gon Sign ErrSecInternalComponent - KaiChu</title><meta name=Description content="Gon is a tool developed by Hashicorp founder Mitchell Hashimoto that makes the whole process of code signing easy. This article documents the problems I encountered with Gon code sign and how I solved them."><meta property="og:title" content="Gon Sign ErrSecInternalComponent"><meta property="og:description" content="Gon is a tool developed by Hashicorp founder Mitchell Hashimoto that makes the whole process of code signing easy. This article documents the problems I encountered with Gon code sign and how I solved them."><meta property="og:type" content="article"><meta property="og:url" content="https://kaichu.io/posts/gon-sign-errsecinternalcomponent/"><meta property="og:image" content="https://kaichu.io/posts/gon-sign-errsecinternalcomponent/img/placeholder.jpg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-11-15T16:12:38+00:00"><meta property="article:modified_time" content="2023-09-07T10:57:33+08:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://kaichu.io/posts/gon-sign-errsecinternalcomponent/img/placeholder.jpg"><meta name=twitter:title content="Gon Sign ErrSecInternalComponent"><meta name=twitter:description content="Gon is a tool developed by Hashicorp founder Mitchell Hashimoto that makes the whole process of code signing easy. This article documents the problems I encountered with Gon code sign and how I solved them."><meta name=application-name content="KaiChu"><meta name=apple-mobile-web-app-title content="KaiChu"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://kaichu.io/posts/gon-sign-errsecinternalcomponent/><link rel=prev href=https://kaichu.io/posts/devfest22-taichung-cloud-workstation-introduction/><link rel=next href=https://kaichu.io/posts/devfest22-taipei-skaffold2-deep-dive/><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13.0/css/all.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@3.7.2/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Gon Sign ErrSecInternalComponent","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/kaichu.io\/posts\/gon-sign-errsecinternalcomponent\/"},"image":[{"@type":"ImageObject","url":"https:\/\/kaichu.io\/posts\/gon-sign-errsecinternalcomponent\/img\/placeholder.jpg","width":1670,"height":490}],"genre":"posts","keywords":"gon, golang, codesign, certificate, alfred","wordcount":913,"url":"https:\/\/kaichu.io\/posts\/gon-sign-errsecinternalcomponent\/","datePublished":"2022-11-15T16:12:38+00:00","dateModified":"2023-09-07T10:57:33+08:00","license":"This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher":{"@type":"Organization","name":"KAI CHU CHUNG","logo":"https:\/\/kaichu.io\/images\/avatar.png"},"author":{"@type":"Person","name":"KAI CHU CHUNG"},"description":"Gon is a tool developed by Hashicorp founder Mitchell Hashimoto that makes the whole process of code signing easy. This article documents the problems I encountered with Gon code sign and how I solved them."}</script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title=KaiChu>KaiChu</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/ title=Home>Home </a><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/tags/alfred>Alfred </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/about/>About </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item language" title="Select Language">English<i class="fas fa-chevron-right fa-fw"></i>
<select class=language-select id=language-select-desktop onchange="location=this.value"><option value=/posts/gon-sign-errsecinternalcomponent/ selected>English</option><option value=/zh-tw/posts/gon-sign-errsecinternalcomponent/>繁體中文</option></select>
</a><span class="menu-item search" id=search-desktop><input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin"></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title=KaiChu>KaiChu</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin"></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/ title=Home>Home</a><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/tags/alfred title>Alfred</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/about/ title>About</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i>
</a><a href=javascript:void(0); class=menu-item title="Select Language">English<i class="fas fa-chevron-right fa-fw"></i>
<select class=language-select onchange="location=this.value"><option value=/posts/gon-sign-errsecinternalcomponent/ selected>English</option><option value=/zh-tw/posts/gon-sign-errsecinternalcomponent/>繁體中文</option></select></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class="toc-content always-active" id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animated flipInX">Gon Sign ErrSecInternalComponent</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw"></i>KAI CHU CHUNG</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2022-11-15>2022-11-15</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;913 words&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;2 minutes&nbsp;</div></div><div class=featured-image><img class=lazyload src=/svg/loading.min.svg data-src=/posts/gon-sign-errsecinternalcomponent/img/placeholder.jpg data-srcset="/posts/gon-sign-errsecinternalcomponent/img/placeholder.jpg, /posts/gon-sign-errsecinternalcomponent/img/placeholder.jpg 1.5x, /posts/gon-sign-errsecinternalcomponent/img/placeholder.jpg 2x" data-sizes=auto alt=/posts/gon-sign-errsecinternalcomponent/img/placeholder.jpg title="Gon is a tool developed by Hashicorp founder Mitchell Hashimoto that makes the whole process of code signing easy. This article documents the problems I encountered with Gon code sign and how I solved them."></div><div class="details toc" id=toc-static kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#gon>Gon</a></li><li><a href=#gon-prerequisite-acquiring-a-developer-id-certificate>Gon Prerequisite: Acquiring a Developer ID Certificate</a></li><li><a href=#gon-local-code-sign>Gon local code sign</a></li><li><a href=#root-cause>Root Cause</a></li><li><a href=#gon-local-code-sign-success>Gon local code sign (success)</a></li></ul></nav></div></div><div class=content id=content><p>Recently, I&rsquo;ve been using Golang with <a href=https://github.com/deanishe/awgo target=_blank rel="noopener noreffer">deanishe/awgo</a> to write Alfred Workflow, which I use a ton.</p><ol><li><p><a href=https://github.com/cage1016/alfred-pdf2image target=_blank rel="noopener noreffer">alfred-pdf2image</a> - Convert PDF to image with Alfred</p></li><li><p><a href=https://github.com/cage1016/alfred-devtoys target=_blank rel="noopener noreffer">alfred-devtoys</a> - A Swiss Army knife for developers for Alfred</p></li><li><p><a href=https://github.com/cage1016/alfred-paletter target=_blank rel="noopener noreffer">alfred-paletter</a> - Extract palette from an image</p></li><li><p><a href=https://github.com/cage1016/ak target=_blank rel="noopener noreffer">ak</a> - A generator for golang alfred workflow that helps you create boilerplate code.</p></li><li><p><a href=https://github.com/cage1016/alfred-opencc target=_blank rel="noopener noreffer">alfred-opencc</a> - Open Chinese Convert 開放中文轉換</p></li><li><p><a href=https://github.com/cage1016/alfred-timelog target=_blank rel="noopener noreffer">alfred-timelog</a> - You could leverage Alfred and Google Sheets to track your time with ease. The goal is to track your time in a way that is easy to understand how much time you spend on.</p></li><li><p><a href=https://github.com/cage1016/alfred-fork-open target=_blank rel="noopener noreffer">alfred-fork-open</a> - Alfred 5 workflow for opening folders in Fork.</p></li></ol><p>In addtion to use them by myself, I also want to share them with others and publish them to <a href=https://www.alfredforum.com/forum/3-share-your-workflows/ target=_blank rel="noopener noreffer">Alfred App Community Forum</a>, which is a website that hosts Alfred workflows forum and allows users to share their workflows with others. When Apple introduced MacOS Catalina, it came with security features to ensure that you only use trusted binary files. This requires that binary files be signed and notarized by Apple itself, otherwise you&rsquo;ll get an error. This problem is encountered when using the <code>Golang</code> base Alfred Workflow.</p><p><figure><a class=lightgallery href=/posts/gon-sign-errsecinternalcomponent/img/developer-cannot-verified.png title=/posts/gon-sign-errsecinternalcomponent/img/developer-cannot-verified.png data-thumbnail=/posts/gon-sign-errsecinternalcomponent/img/developer-cannot-verified.png data-sub-html="<h2>developer cannot verified</h2>"><img class=lazyload src=/svg/loading.min.svg data-src=img/developer-cannot-verified.png data-srcset="/posts/gon-sign-errsecinternalcomponent/img/developer-cannot-verified.png, img/developer-cannot-verified.png 1.5x, /posts/gon-sign-errsecinternalcomponent/img/developer-cannot-verified.png 2x" data-sizes=auto alt=/posts/gon-sign-errsecinternalcomponent/img/developer-cannot-verified.png></a><figcaption class=image-caption>developer cannot verified</figcaption></figure></p><p>Of course, it is possible to allow forced enable in the MacOS &ldquo;Security and Privacy Preferences&rdquo;, but this would create a security problem for other users because there is no way to determine if the application being run is trusted. The correct way to do this is to request a &ldquo;Developer ID Application&rdquo; certificate and add the certificate to the compile command at compile time。Cause all of my workflows are written in <code>Golang</code> and publish by Github Action. So, this article document the problems I encountered with <a href=https://github.com/mitchellh/gon target=_blank rel="noopener noreffer">Gon</a> code sign and how I solved them by following the steps below from <a href=https://www.kencochrane.com/2020/08/01/build-and-sign-golang-binaries-for-macos-with-github-actions/ target=_blank rel="noopener noreffer">Build, notarize, and sign Golang binaries for MacOS with GitHub Actions · KenCochrane.com</a></p><h2 id=gon>Gon</h2><p><a href=https://github.com/mitchellh/gon target=_blank rel="noopener noreffer">Gon</a> is a tool that allows you to sign and notarize your binaries with a single command and developed by <a href=https://www.hashicorp.com/ target=_blank rel="noopener noreffer">Hashicorp</a> founder <a href=https://github.com/mitchellh target=_blank rel="noopener noreffer">Mitchell Hashimoto</a></p><h2 id=gon-prerequisite-acquiring-a-developer-id-certificate>Gon Prerequisite: Acquiring a Developer ID Certificate</h2><ol><li>Login to <a href=https://developer.apple.com/ target=_blank rel="noopener noreffer">Apple Developer</a> and create a new certificate.</li><li>Visit <a href=https://developer.apple.com/account/resources/certificates/list target=_blank rel="noopener noreffer">Certificates, Identifiers & Profiles</a></li><li>Click the + button to add a new certificate and select &ldquo;Developer ID Application&rdquo; at Software part and continue to follow the steps to create a new certificate.</li><li>Download <code>Developer ID Application</code> certificate and double click to install it into your keychain.</li></ol><p>Verify that the certificate is installed by running the following command</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ security find-identity -v <span class=p>|</span> grep Developer
</span></span><span class=line><span class=cl>  2<span class=o>)</span> 20DFD3FCBB8283C498F07D784871F91353A270D3 <span class=s2>&#34;Developer ID Application: Name (5ST5F35WQV)&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=gon-local-code-sign>Gon local code sign</h2><p>When certificate is ready, we could use <a href=https://github.com/mitchellh/gon target=_blank rel="noopener noreffer">Gon</a> to sign the binary file with <code>gon.json</code> configuare file.</p><p><strong>gon.json</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;source&#34;</span> : <span class=o>[</span><span class=s2>&#34;./exe&#34;</span><span class=o>]</span>,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;bundle_id&#34;</span> : <span class=s2>&#34;com.kaichu.example.c&#34;</span>,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;apple_id&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;username&#34;</span> : <span class=s2>&#34;&lt;your-email&gt;&#34;</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;password&#34;</span>:  <span class=s2>&#34;@env:AC_PASSWORD&#34;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;sign&#34;</span> :<span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;application_identity&#34;</span> : <span class=s2>&#34;Developer ID Application: KAI CHU CHUNG&#34;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ gon -log-level<span class=o>=</span>debug -log-json ./gon.json
</span></span><span class=line><span class=cl><span class=o>==</span>&gt; ✏️  Signing files...
</span></span><span class=line><span class=cl><span class=o>{</span><span class=s2>&#34;@level&#34;</span>:<span class=s2>&#34;info&#34;</span>,<span class=s2>&#34;@message&#34;</span>:<span class=s2>&#34;executing codesigning&#34;</span>,<span class=s2>&#34;@module&#34;</span>:<span class=s2>&#34;sign&#34;</span>,<span class=s2>&#34;@timestamp&#34;</span>:<span class=s2>&#34;2022-11-16T09:33:32.508890+08:00&#34;</span>,<span class=s2>&#34;command_args&#34;</span>:<span class=o>[</span><span class=s2>&#34;codesign&#34;</span>,<span class=s2>&#34;-s&#34;</span>,<span class=s2>&#34;Developer ID Application: KAI CHU CHUNG&#34;</span>,<span class=s2>&#34;-f&#34;</span>,<span class=s2>&#34;-v&#34;</span>,<span class=s2>&#34;--timestamp&#34;</span>,<span class=s2>&#34;--options&#34;</span>,<span class=s2>&#34;runtime&#34;</span>,<span class=s2>&#34;./exe&#34;</span><span class=o>]</span>,<span class=s2>&#34;command_path&#34;</span>:<span class=s2>&#34;/usr/bin/codesign&#34;</span>,<span class=s2>&#34;files&#34;</span>:<span class=o>[</span><span class=s2>&#34;./exe&#34;</span><span class=o>]}</span>
</span></span><span class=line><span class=cl><span class=o>{</span><span class=s2>&#34;@level&#34;</span>:<span class=s2>&#34;error&#34;</span>,<span class=s2>&#34;@message&#34;</span>:<span class=s2>&#34;error codesigning&#34;</span>,<span class=s2>&#34;@module&#34;</span>:<span class=s2>&#34;sign&#34;</span>,<span class=s2>&#34;@timestamp&#34;</span>:<span class=s2>&#34;2022-11-16T09:33:32.599347+08:00&#34;</span>,<span class=s2>&#34;err&#34;</span>:<span class=s2>&#34;exit status 1&#34;</span>,<span class=s2>&#34;output&#34;</span>:<span class=s2>&#34;./exe: replacing existing signature\nWarning: unable to build chain to self-signed root for signer \&#34;Developer ID Application: KAI CHU CHUNG (5ST5F35WQV)\&#34;\n./exe: errSecInternalComponent\n&#34;</span><span class=o>}</span>
</span></span><span class=line><span class=cl>❗️ Error signing files:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>error signing:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>./exe: replacing existing signature
</span></span><span class=line><span class=cl>Warning: unable to build chain to self-signed root <span class=k>for</span> signer <span class=s2>&#34;Developer ID Application: KAI CHU CHUNG (5ST5F35WQV)&#34;</span>
</span></span><span class=line><span class=cl>./exe: errSecInternalComponent
</span></span></code></pre></td></tr></table></div></div><p>BOOM, we got an error <code>./exe: errSecInternalComponent</code> when we try to sign the binary file.</p><h2 id=root-cause>Root Cause</h2><p><figure><a class=lightgallery href=/posts/gon-sign-errsecinternalcomponent/img/certificates-not-trusted.jpg title=/posts/gon-sign-errsecinternalcomponent/img/certificates-not-trusted.jpg data-thumbnail=/posts/gon-sign-errsecinternalcomponent/img/certificates-not-trusted.jpg data-sub-html="<h2>Certificates not trusted</h2>"><img class=lazyload src=/svg/loading.min.svg data-src=img/certificates-not-trusted.jpg data-srcset="/posts/gon-sign-errsecinternalcomponent/img/certificates-not-trusted.jpg, img/certificates-not-trusted.jpg 1.5x, /posts/gon-sign-errsecinternalcomponent/img/certificates-not-trusted.jpg 2x" data-sizes=auto alt=/posts/gon-sign-errsecinternalcomponent/img/certificates-not-trusted.jpg></a><figcaption class=image-caption>Certificates not trusted</figcaption></figure></p><p>This error is caused by the certificate is not trusted by the system and does not work that even we force enable trust manually in keychain. We could fix this by adding the intermediate certificate to the keychain. We could download the intermediate certificate from <a href=https://www.apple.com/certificateauthority/ target=_blank rel="noopener noreffer">Apple PKI - Apple</a> website</p><p><figure><a class=lightgallery href=/posts/gon-sign-errsecinternalcomponent/img/apple-pki.jpg title=/posts/gon-sign-errsecinternalcomponent/img/apple-pki.jpg data-thumbnail=/posts/gon-sign-errsecinternalcomponent/img/apple-pki.jpg data-sub-html="<h2>Apple PKI</h2>"><img class=lazyload src=/svg/loading.min.svg data-src=img/apple-pki.jpg data-srcset="/posts/gon-sign-errsecinternalcomponent/img/apple-pki.jpg, img/apple-pki.jpg 1.5x, /posts/gon-sign-errsecinternalcomponent/img/apple-pki.jpg 2x" data-sizes=auto alt=/posts/gon-sign-errsecinternalcomponent/img/apple-pki.jpg></a><figcaption class=image-caption>Apple PKI</figcaption></figure></p><p>There are two intermediate certificates for <code>Developer ID Application</code> certificate, we could download same type as <code>Developer ID Application</code> certificate we request in the beginning and install them into the keychain.</p><ul><li>Developer ID - G1 (Expiring 02/01/2027 22:12:15 UTC)</li><li>Developer ID - G2 (Expiring 09/17/2031 00:00:00 UTC)</li></ul><p><figure><a class=lightgallery href=/posts/gon-sign-errsecinternalcomponent/img/certificates-verified.jpg title=/posts/gon-sign-errsecinternalcomponent/img/certificates-verified.jpg data-thumbnail=/posts/gon-sign-errsecinternalcomponent/img/certificates-verified.jpg data-sub-html="<h2>Certificates verified</h2>"><img class=lazyload src=/svg/loading.min.svg data-src=img/certificates-verified.jpg data-srcset="/posts/gon-sign-errsecinternalcomponent/img/certificates-verified.jpg, img/certificates-verified.jpg 1.5x, /posts/gon-sign-errsecinternalcomponent/img/certificates-verified.jpg 2x" data-sizes=auto alt=/posts/gon-sign-errsecinternalcomponent/img/certificates-verified.jpg></a><figcaption class=image-caption>Certificates verified</figcaption></figure></p><h2 id=gon-local-code-sign-success>Gon local code sign (success)</h2><p>Re run the <code>gon</code> command again, we could see the binary file is signed successfully.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ gon -log-level<span class=o>=</span>debug -log-json ./gon.json
</span></span><span class=line><span class=cl><span class=o>==</span>&gt; ✏️  Signing files...
</span></span><span class=line><span class=cl><span class=o>{</span><span class=s2>&#34;@level&#34;</span>:<span class=s2>&#34;info&#34;</span>,<span class=s2>&#34;@message&#34;</span>:<span class=s2>&#34;executing codesigning&#34;</span>,<span class=s2>&#34;@module&#34;</span>:<span class=s2>&#34;sign&#34;</span>,<span class=s2>&#34;@timestamp&#34;</span>:<span class=s2>&#34;2022-11-16T14:05:09.694431+08:00&#34;</span>,<span class=s2>&#34;command_args&#34;</span>:<span class=o>[</span><span class=s2>&#34;codesign&#34;</span>,<span class=s2>&#34;-s&#34;</span>,<span class=s2>&#34;Developer ID Application: KAI CHU CHUNG&#34;</span>,<span class=s2>&#34;-f&#34;</span>,<span class=s2>&#34;-v&#34;</span>,<span class=s2>&#34;--timestamp&#34;</span>,<span class=s2>&#34;--options&#34;</span>,<span class=s2>&#34;runtime&#34;</span>,<span class=s2>&#34;./exe&#34;</span><span class=o>]</span>,<span class=s2>&#34;command_path&#34;</span>:<span class=s2>&#34;/usr/bin/codesign&#34;</span>,<span class=s2>&#34;files&#34;</span>:<span class=o>[</span><span class=s2>&#34;./exe&#34;</span><span class=o>]}</span>
</span></span><span class=line><span class=cl><span class=o>{</span><span class=s2>&#34;@level&#34;</span>:<span class=s2>&#34;info&#34;</span>,<span class=s2>&#34;@message&#34;</span>:<span class=s2>&#34;codesigning complete&#34;</span>,<span class=s2>&#34;@module&#34;</span>:<span class=s2>&#34;sign&#34;</span>,<span class=s2>&#34;@timestamp&#34;</span>:<span class=s2>&#34;2022-11-16T14:05:10.537608+08:00&#34;</span>,<span class=s2>&#34;output&#34;</span>:<span class=s2>&#34;./exe: replacing existing signature\n./exe: signed Mach-O universal (x86_64 arm64) [exe]\n&#34;</span><span class=o>}</span>
</span></span><span class=line><span class=cl>    Code signing successful
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>⚠️  No items to notarize
</span></span><span class=line><span class=cl>You must specify a <span class=s1>&#39;notarize&#39;</span> section or a <span class=s1>&#39;source&#39;</span> section plus a <span class=s1>&#39;zip&#39;</span> or <span class=s1>&#39;dmg&#39;</span> section in your configuration to <span class=nb>enable</span> packaging and notarization. Without these sections, gon
</span></span><span class=line><span class=cl>will only sign your input files in <span class=s1>&#39;source&#39;</span>.
</span></span></code></pre></td></tr></table></div></div><p>Verify the binary file is signed successfully by running the following command</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ codesign -dvv exe
</span></span><span class=line><span class=cl><span class=nv>Executable</span><span class=o>=</span>/Users/kaichuchung/tmp/c/exe
</span></span><span class=line><span class=cl><span class=nv>Identifier</span><span class=o>=</span>exe
</span></span><span class=line><span class=cl><span class=nv>Format</span><span class=o>=</span>Mach-O universal <span class=o>(</span>x86_64 arm64<span class=o>)</span>
</span></span><span class=line><span class=cl>CodeDirectory <span class=nv>v</span><span class=o>=</span><span class=m>20500</span> <span class=nv>size</span><span class=o>=</span><span class=m>12015</span> <span class=nv>flags</span><span class=o>=</span>0x10000<span class=o>(</span>runtime<span class=o>)</span> <span class=nv>hashes</span><span class=o>=</span>370+2 <span class=nv>location</span><span class=o>=</span>embedded
</span></span><span class=line><span class=cl>Signature <span class=nv>size</span><span class=o>=</span><span class=m>9058</span>
</span></span><span class=line><span class=cl><span class=nv>Authority</span><span class=o>=</span>Developer ID Application: KAI CHU CHUNG <span class=o>(</span>5ST5F35WQV<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=nv>Authority</span><span class=o>=</span>Developer ID Certification Authority
</span></span><span class=line><span class=cl><span class=nv>Authority</span><span class=o>=</span>Apple Root CA
</span></span><span class=line><span class=cl><span class=nv>Timestamp</span><span class=o>=</span>Nov 16, <span class=m>2022</span> at 00:26:11
</span></span><span class=line><span class=cl>Info.plist<span class=o>=</span>not bound
</span></span><span class=line><span class=cl><span class=nv>TeamIdentifier</span><span class=o>=</span>5ST5F35WQV
</span></span><span class=line><span class=cl>Runtime <span class=nv>Version</span><span class=o>=</span>10.9.0
</span></span><span class=line><span class=cl>Sealed <span class=nv>Resources</span><span class=o>=</span>none
</span></span><span class=line><span class=cl>Internal requirements <span class=nv>count</span><span class=o>=</span><span class=m>1</span> <span class=nv>size</span><span class=o>=</span><span class=m>164</span>
</span></span></code></pre></td></tr></table></div></div><p>Now, we could use <code>gon</code> to sign and notarize the binary file successfully. The next step is to use <code>gon</code> to sign and notarize the binary file in Github Action relase pipeline.</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2023-09-07&nbsp;<a class=git-hash href=https://github.com/cage1016/kaichu.io.hugo/commit/43a38bf1a203421ca897ea655745aa0f52e9907b target=_blank title="commit by Kai-Chu Chung(cage.chung@gmail.com) 43a38bf1a203421ca897ea655745aa0f52e9907b: add Alfred Theme Black Golden">
<i class="fas fa-hashtag fa-fw"></i>43a38bf</a></span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=/posts/gon-sign-errsecinternalcomponent/index.md target=_blank>Read Markdown</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://kaichu.io/posts/gon-sign-errsecinternalcomponent/ data-title="Gon Sign ErrSecInternalComponent" data-via=CageChung data-hashtags=gon,golang,codesign,certificate,alfred><i class="fab fa-twitter fa-fw"></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://kaichu.io/posts/gon-sign-errsecinternalcomponent/ data-hashtag=gon><i class="fab fa-facebook-square fa-fw"></i></a><a href=javascript:void(0); title="Share on Linkedin" data-sharer=linkedin data-url=https://kaichu.io/posts/gon-sign-errsecinternalcomponent/><i class="fab fa-linkedin fa-fw"></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/gon/>gon</a>,&nbsp;<a href=/tags/golang/>golang</a>,&nbsp;<a href=/tags/codesign/>codesign</a>,&nbsp;<a href=/tags/certificate/>certificate</a>,&nbsp;<a href=/tags/alfred/>alfred</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/posts/devfest22-taichung-cloud-workstation-introduction/ class=prev rel=prev title="Devfest22 Taichung Cloud Workstation Introduction"><i class="fas fa-angle-left fa-fw"></i>Devfest22 Taichung Cloud Workstation Introduction</a>
<a href=/posts/devfest22-taipei-skaffold2-deep-dive/ class=next rel=next title="Devfest22 Taipei Skaffold2 Deep Dive">Devfest22 Taipei Skaffold2 Deep Dive<i class="fas fa-angle-right fa-fw"></i></a></div></div><div id=comments><div id=utterances></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://utteranc.es/>Utterances</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.118.2">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a></div><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2019 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank>KAI CHU CHUNG</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw"></i></a></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/lightgallery.js@1.2.0/dist/css/lightgallery.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/asciinema-player@2.6.1/resources/public/css/asciinema-player.css><script type=text/javascript src=https://cdn.jsdelivr.net/npm/smooth-scroll@16.1.3/dist/smooth-scroll.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/autocomplete.js@0.37.1/dist/autocomplete.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/algoliasearch@4.2.0/dist/algoliasearch-lite.umd.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.2.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery.js@1.2.0/dist/js/lightgallery.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lg-thumbnail.js@1.2.0/dist/lg-thumbnail.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lg-zoom.js@1.2.0/dist/lg-zoom.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.4.0/sharer.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:1e3},comment:{utterances:{darkTheme:"github-dark",issueTerm:"pathname",label:"comment",lightTheme:"github-light",repo:"cage1016/cage1016.github.io"}},lightGallery:{actualSize:!1,exThumbImage:"data-thumbnail",hideBarsDelay:2e3,selector:".lightgallery",speed:400,thumbContHeight:80,thumbWidth:80,thumbnail:!0},search:{algoliaAppID:"IB21BAKK19",algoliaIndex:"index.en",algoliaSearchKey:"8883d25f4767d3d2848450e3afa6cf05",highlightTag:"em",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"algolia"}}</script><script type=text/javascript src=/js/theme.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/asciinema-player@2.6.1/resources/public/js/asciinema-player.min.js></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-65308340-1",{anonymize_ip:!0})</script><script type=text/javascript src="https://www.googletagmanager.com/gtag/js?id=UA-65308340-1" async></script></body></html>